# 1. Use an official Java 21 runtime as a parent image
FROM eclipse-temurin:21-jdk-alpine

# 2. Add a volume pointing to /tmp (optional but good practice for Spring Boot)
VOLUME /tmp

# 3. The application's jar file (matches the one created by Maven/Gradle)
ARG JAR_FILE=target/*.jar

# 4. Copy the jar file to the container
COPY ${JAR_FILE} app.jar

# -------------------------------------------------------
# ðŸ”´ THE FIX FOR YOUR EMAIL ERROR
# This environment variable forces Java to use IPv4 inside the container.
# This prevents the Gmail connection from hanging/timing out.
# -------------------------------------------------------
ENV JAVA_TOOL_OPTIONS="-Djava.net.preferIPv4Stack=true"

# 5. Execute the application
ENTRYPOINT ["java", "-jar", "/app.jar"]